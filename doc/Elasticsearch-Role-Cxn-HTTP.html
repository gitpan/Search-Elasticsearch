<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<link rel='stylesheet' href='https://metacpan.org/_asset/288683e3285b02987a848283f0f92207' type='text/css'>
<script type='text/javascript' src='https://metacpan.org/_asset/12b19d083bf773523c065d4d729f0327'></script>
</head>
<body>
<div class="pod">


<ul id="index">
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#CONFIGURATION">CONFIGURATION</a>
    <ul>
      <li><a href="#node"><code>node</code></a></li>
      <li><a href="#max_content_length"><code>max_content_length</code></a></li>
      <li><a href="#deflate"><code>deflate</code></a></li>
    </ul>
  </li>
  <li><a href="#METHODS">METHODS</a>
    <ul>
      <li><a href="#scheme-"><code>scheme()</code></a></li>
      <li><a href="#is_https-"><code>is_https()</code></a></li>
      <li><a href="#userinfo-"><code>userinfo()</code></a></li>
      <li><a href="#default_headers-"><code>default_headers()</code></a></li>
      <li><a href="#max_content_length-"><code>max_content_length()</code></a></li>
      <li><a href="#build_uri-"><code>build_uri()</code></a></li>
    </ul>
  </li>
</ul>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p><a href="./Elasticsearch::Role::Cxn::HTTP">Elasticsearch::Role::Cxn::HTTP</a> provides common functionality to the Cxn implementations which use the HTTP protocol. Cxn instances are created by a <a href="./Elasticsearch::Role::CxnPool">Elasticsearch::Role::CxnPool</a> implentation, using the <a href="./Elasticsearch::Cxn::Factory">Elasticsearch::Cxn::Factory</a> class.</p>

<p>This class does <a href="./Elasticsearch::Role::Cxn">Elasticsearch::Role::Cxn</a>.</p>

<h1 id="CONFIGURATION">CONFIGURATION</h1>

<p>The configuration options are as follows:</p>

<h2 id="node"><code>node</code></h2>

<p>A single <code>node</code> is passed to <code>new()</code> by the <a href="./Elasticsearch::Cxn::Factory">Elasticsearch::Cxn::Factory</a> class. It can either be a URI or a hash containing each part. For instance:</p>

<pre class="brush: pl; class-name: 'highlight'; toolbar: false; gutter: false">    node =&gt; &#39;localhost&#39;;                    # equiv of &#39;http://localhost:80&#39;
    node =&gt; &#39;localhost:9200&#39;;               # equiv of &#39;http://localhost:9200&#39;
    node =&gt; &#39;http://localhost:9200&#39;;

    node =&gt; &#39;https://localhost&#39;;            # equiv of &#39;https://localhost:443&#39;
    node =&gt; &#39;localhost/path&#39;;               # equiv of &#39;http://localhost:80/path&#39;


    node =&gt; &#39;http://user:pass@localhost&#39;;   # equiv of &#39;http://localhost:80&#39;
                                            # with userinfo =&gt; &#39;user:pass&#39;</pre>

<p>Alternatively, a <code>node</code> can be specified as a hash:</p>

<pre class="brush: pl; class-name: 'highlight'; toolbar: false; gutter: false">    {
        scheme      =&gt; &#39;http&#39;,
        host        =&gt; &#39;search.domain.com&#39;,
        port        =&gt; &#39;9200&#39;,
        path        =&gt; &#39;/path&#39;,
        userinfo    =&gt; &#39;user:pass&#39;
    }</pre>

<p>Similarly, default values can be specified with <code>port</code>, <code>path_prefix</code>, <code>userinfo</code> and <code>use_https</code>:</p>

<pre class="brush: pl; class-name: 'highlight'; toolbar: false; gutter: false">    $e = Elasticsearch-&gt;new(
        port        =&gt; 9201,
        path_prefix =&gt; &#39;/path&#39;,
        userinfo    =&gt; &#39;user:pass&#39;,
        use_https   =&gt; 1,
        nodes       =&gt; [ &#39;search1&#39;, &#39;search2&#39; ]
    )</pre>

<h2 id="max_content_length"><code>max_content_length</code></h2>

<p>By default, Elasticsearch nodes accept a maximum post body of 100MB or <code>104_857_600</code> bytes. This client enforces that limit. The limit can be customised with the <code>max_content_length</code> parameter (specified in bytes).</p>

<p>If you&#39;re using the <a href="./Elasticsearch::CxnPool::Sniff">Elasticsearch::CxnPool::Sniff</a> module, then the <code>max_content_length</code> will be automatically retrieved from the live cluster, unless you specify a custom <code>max_content_length</code>:</p>

<pre class="brush: pl; class-name: 'highlight'; toolbar: false; gutter: false">    # max_content_length retrieved from cluster
    $e = Elasticsearch-&gt;new(
        cxn_pool =&gt; &#39;Sniff&#39;
    );

    # max_content_length fixed at 10,000 bytes
    $e = Elasticsearch-&gt;new(
        cxn_pool           =&gt; &#39;Sniff&#39;,
        max_content_length =&gt; 10_000
    );</pre>

<h2 id="deflate"><code>deflate</code></h2>

<p>This client can request compressed responses from Elasticsearch by enabling the <code>http.compression</code> config setting in <a href="http://www.elasticsearch.org/guide/reference/modules/http/">Elasticsearch</a> and setting <code>deflate</code> to <code>true</code>:</p>

<pre class="brush: pl; class-name: 'highlight'; toolbar: false; gutter: false">    $e = Elasticsearch-&gt;new(
        deflate =&gt; 1
    );</pre>

<h1 id="METHODS">METHODS</h1>

<p>None of the methods listed below are useful to the user. They are documented for those who are writing alternative implementations only.</p>

<h2 id="scheme-"><code>scheme()</code></h2>

<pre class="brush: pl; class-name: 'highlight'; toolbar: false; gutter: false">    $scheme = $cxn-&gt;scheme;</pre>

<p>Returns the scheme of the connection, ie <code>http</code> or <code>https</code>.</p>

<h2 id="is_https-"><code>is_https()</code></h2>

<pre class="brush: pl; class-name: 'highlight'; toolbar: false; gutter: false">    $bool = $cxn-&gt;is_https;</pre>

<p>Returns <code>true</code> or <code>false</code> depending on whether the <code>/scheme()</code> is <code>https</code> or not.</p>

<h2 id="userinfo-"><code>userinfo()</code></h2>

<pre class="brush: pl; class-name: 'highlight'; toolbar: false; gutter: false">    $userinfo = $cxn-&gt;userinfo</pre>

<p>Returns the username and password of the cxn, if any, eg <code>&quot;user:pass&quot;</code>. If <code>userinfo</code> is provided, then a Basic Authorization header is added to each request.</p>

<h2 id="default_headers-"><code>default_headers()</code></h2>

<pre class="brush: pl; class-name: 'highlight'; toolbar: false; gutter: false">    $headers = $cxn-&gt;default_headers</pre>

<p>The default headers that are passed with each request. This includes the <code>Accept-Encoding</code> header if <code>/deflate</code> is true, and the <code>Authorization</code> header if <code>/userinfo</code> has a value.</p>

<h2 id="max_content_length-"><code>max_content_length()</code></h2>

<pre class="brush: pl; class-name: 'highlight'; toolbar: false; gutter: false">    $int = $cxn-&gt;max_content_length;</pre>

<p>Returns the maximum length in bytes that the HTTP body can have.</p>

<h2 id="build_uri-"><code>build_uri()</code></h2>

<pre class="brush: pl; class-name: 'highlight'; toolbar: false; gutter: false">    $uri = $cxn-&gt;build_uri({ path =&gt; &#39;/_search&#39;, qs =&gt; { size =&gt; 10 }});</pre>

<p>Returns the HTTP URI to use for a particular request, combining the passed in <code>path</code> parameter with any defined <code>path_prefix</code>, and adding the query-string parameters.</p>


</div>
</body>
</html>


